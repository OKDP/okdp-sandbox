apiVersion: v1alpha1
name: coredns-patch
tag: 1.0.0-p03
protected: false
description: |
  CoreDNS configuration patch to resolve local domain names to ingress controller
usage:
  text: |
    CoreDNS Patch configures CoreDNS to automatically resolve domain names 
    matching the ingress suffix pattern to the ingress controller.
    This enables local development with custom domain names.
schema:
  parameters:
    properties:
      ingressService: { type: string, default: "ingress-nginx-controller.ingress-nginx.svc.cluster.local" }
  context:
    properties:
      ingress:
        required: true
        properties:
          suffix: { type: string, required: true }
modules:
  - name: main
    timeout: 10m
    source:
      local:
        path: ../charts/coredns-patch/0.1.0
    values: |
      ingressSuffix: "{{ .Context.ingress.suffix }}"
      ingressService: "{{ .Parameters.ingressService }}"
      job:
        image: quay.io/okdp/sandbox-images/kubectl:latest
        restartPolicy: OnFailure
        nodeSelector:
          kubernetes.io/os: linux
roles:
  - coredns
dependencies: |
  [] 